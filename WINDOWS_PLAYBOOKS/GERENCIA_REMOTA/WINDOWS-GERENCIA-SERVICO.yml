---
- name: Gerenciar serviço no Windows via Survey
  hosts: all
  gather_facts: false
  vars:
    service_name: ""     # informado via survey
    service_action: ""   # start | stop | restart - informado via survey

  tasks:

    - name: Validar entrada da ação
      assert:
        that:
          - service_action in ['start', 'stop', 'restart']
        fail_msg: "A ação '{{ service_action }}' não é válida. Use: start, stop ou restart."

    - name: Gerenciar o serviço {{ service_name }} no Windows
      ansible.windows.win_service:
        name: "{{ service_name }}"
        state: "{{ service_action }}"